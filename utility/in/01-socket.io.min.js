/*! Socket.IO.min.js build:0.8.7, production. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */
(function(e,d){var f=e;f.version="0.8.7",f.protocol=1,f.transports=[],f.j=[],f.sockets={},f.connect=function(b,l){var k=f.util.parseUri(b),j,i;d&&d.location&&(k.protocol=k.protocol||d.location.protocol.slice(0,-1),k.host=k.host||(d.document?d.document.domain:d.location.hostname),k.port=k.port||d.location.port),j=f.util.uniqueUri(k);var c={host:k.host,secure:"https"==k.protocol,port:k.port||("https"==k.protocol?443:80),query:k.query||""};f.util.merge(c,l);if(c["force new connection"]||!f.sockets[j]){i=new f.Socket(c)}!c["force new connection"]&&i&&(f.sockets[j]=i),i=i||f.sockets[j];return i.of(k.path.length>1?k.path:"")}})("object"==typeof module?module.exports:this.io={},this),function(i,h){var n=i.util={},m=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,l=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){var d=m.exec(e||""),o={},g=14;while(g--){o[l[g]]=d[g]||""}return o},n.uniqueUri=function(b){var o=b.protocol,g=b.host,f=b.port;"document" in h?(g=g||document.domain,f=f||(o=="https"&&document.location.protocol!=="https:"?443:document.location.port)):(g=g||"localhost",!f&&o=="https"&&(f=443));return(o||"http")+"://"+g+":"+(f||80)},n.query=function(g,c){var q=n.chunkQuery(g||""),p=[];n.merge(q,n.chunkQuery(c||""));for(var o in q){q.hasOwnProperty(o)&&p.push(o+"="+q[o])}return p.length?"?"+p.join("&"):""},n.chunkQuery=function(o){var g={},s=o.split("&"),r=0,q=s.length,p;for(;r<q;++r){p=s[r].split("="),p[0]&&(g[p[0]]=decodeURIComponent(p[1]))}return g};var k=!1;n.load=function(b){if("document" in h&&document.readyState==="complete"||k){return b()}n.on(h,"load",b,!1)},n.on=function(f,e,o,g){f.attachEvent?f.attachEvent("on"+e,o):f.addEventListener&&f.addEventListener(e,o,g)},n.request=function(d){if(d&&"undefined"!=typeof XDomainRequest){return new XDomainRequest}if("undefined"!=typeof XMLHttpRequest&&(!d||n.ua.hasCORS)){return new XMLHttpRequest}if(!d){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}return null},"undefined"!=typeof window&&n.load(function(){k=!0}),n.defer=function(b){if(!n.ua.webkit||"undefined"!=typeof importScripts){return b()}n.load(function(){setTimeout(b,100)})},n.merge=function j(o,c,t,s){var r=s||[],q=typeof t=="undefined"?2:t,p;for(p in c){c.hasOwnProperty(p)&&n.indexOf(r,p)<0&&(typeof o[p]!="object"||!q?(o[p]=c[p],r.push(c[p])):n.merge(o[p],c[p],q-1,r))}return o},n.mixin=function(d,c){n.merge(d.prototype,c.prototype)},n.inherit=function(e,d){function f(){}f.prototype=d.prototype,e.prototype=new f},n.isArray=Array.isArray||function(b){return Object.prototype.toString.call(b)==="[object Array]"},n.intersect=function(o,c){var t=[],s=o.length>c.length?o:c,r=o.length>c.length?c:o;for(var q=0,p=r.length;q<p;q++){~n.indexOf(s,r[q])&&t.push(r[q])}return t},n.indexOf=function(f,e,o){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(f,e,o)}for(var g=f.length,o=o<0?o+g<0?0:o+g:o||0;o<g&&f[o]!==e;o++){}return g<=o?-1:o},n.toArray=function(f){var e=[];for(var o=0,g=f.length;o<g;o++){e.push(f[o])}return e},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var d=new XMLHttpRequest}catch(c){return !1}return d.withCredentials!=undefined}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,d){function f(){}e.EventEmitter=f,f.prototype.on=function(b,g){this.$events||(this.$events={}),this.$events[b]?d.util.isArray(this.$events[b])?this.$events[b].push(g):this.$events[b]=[this.$events[b],g]:this.$events[b]=g;return this},f.prototype.addListener=f.prototype.on,f.prototype.once=function(h,g){function i(){j.removeListener(h,i),g.apply(this,arguments)}var j=this;i.listener=g,this.on(h,i);return this},f.prototype.removeListener=function(b,l){if(this.$events&&this.$events[b]){var k=this.$events[b];if(d.util.isArray(k)){var j=-1;for(var i=0,h=k.length;i<h;i++){if(k[i]===l||k[i].listener&&k[i].listener===l){j=i;break}}if(j<0){return this}k.splice(j,1),k.length||delete this.$events[b]}else{(k===l||k.listener&&k.listener===l)&&delete this.$events[b]}}return this},f.prototype.removeAllListeners=function(b){this.$events&&this.$events[b]&&(this.$events[b]=null);return this},f.prototype.listeners=function(b){this.$events||(this.$events={}),this.$events[b]||(this.$events[b]=[]),d.util.isArray(this.$events[b])||(this.$events[b]=[this.$events[b]]);return this.$events[b]},f.prototype.emit=function(b){if(!this.$events){return !1}var l=this.$events[b];if(!l){return !1}var k=Array.prototype.slice.call(arguments,1);if("function"==typeof l){l.apply(this,k)}else{if(!d.util.isArray(l)){return !1}var j=l.slice();for(var i=0,h=j.length;i<h;i++){j[i].apply(this,k)}}return !0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i instanceof Date&&(i=date(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i){return"null"}gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1){h[c]=str(c,i)||"null"}e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g;return e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1){typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}}else{for(d in i){Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}}e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g;return e}}function quote(a){escapable.lastIndex=0;return escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function date(a,b){return isFinite(a.valueOf())?a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"Z":null}function f(a){return a<10?"0"+a:a}"use strict";if(nativeJSON&&nativeJSON.parse){return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify}}var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number"){for(d=0;d<c;d+=1){indent+=" "}}else{typeof c=="string"&&(indent=c)}rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number"){return str("",{"":a})}throw new Error("JSON.stringify")},JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object"){for(c in e){Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c])}}return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,typeof JSON!="undefined"?JSON:undefined),function(r,q){var p=r.parser={},o=p.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],n=p.reasons=["transport not supported","client not handshaken","unauthorized"],m=p.advice=["reconnect"],l=q.JSON,k=q.util.indexOf;p.encodePacket=function(w){var v=k(o,w.type),u=w.id||"",t=w.endpoint||"",s=w.ack,h=null;switch(w.type){case"error":var g=w.reason?k(n,w.reason):"",f=w.advice?k(m,w.advice):"";if(g!==""||f!==""){h=g+(f!==""?"+"+f:"")}break;case"message":w.data!==""&&(h=w.data);break;case"event":var e={name:w.name};w.args&&w.args.length&&(e.args=w.args),h=l.stringify(e);break;case"json":h=l.stringify(w.data);break;case"connect":w.qs&&(h=w.qs);break;case"ack":h=w.ackId+(w.args&&w.args.length?"+"+l.stringify(w.args):"")}var d=[v,u+(s=="data"?"+":""),t];h!==null&&h!==undefined&&d.push(h);return d.join(":")},p.encodePayload=function(g){var f="";if(g.length==1){return g[0]}for(var s=0,i=g.length;s<i;s++){var h=g[s];f+="\ufffd"+h.length+"\ufffd"+g[s]}return f};var j=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;p.decodePacket=function(e){var d=e.match(j);if(!d){return{}}var s=d[2]||"",e=d[5]||"",i={type:o[d[1]],endpoint:d[4]||""};s&&(i.id=s,d[3]?i.ack="data":i.ack=!0);switch(i.type){case"error":var d=e.split("+");i.reason=n[d[0]]||"",i.advice=m[d[1]]||"";break;case"message":i.data=e||"";break;case"event":try{var g=l.parse(e);i.name=g.name,i.args=g.args}catch(f){}i.args=i.args||[];break;case"json":try{i.data=l.parse(e)}catch(f){}break;case"connect":i.qs=e||"";break;case"ack":var d=e.match(/^([0-9]+)(\+)?(.*)/);if(d){i.ackId=d[1],i.args=[];if(d[3]){try{i.args=d[3]?l.parse(d[3]):[]}catch(f){}}}break;case"disconnect":case"heartbeat":}return i},p.decodePayload=function(f){if(f.charAt(0)=="\ufffd"){var c=[];for(var h=1,g="";h<f.length;h++){f.charAt(h)=="\ufffd"?(c.push(p.decodePacket(f.substr(h+1).substr(0,g))),h+=Number(g)+1,g=""):g+=f.charAt(h)}return c}return[p.decodePacket(f)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,d){function f(g,c){this.socket=g,this.sessid=c}e.Transport=f,d.util.mixin(f,d.EventEmitter),f.prototype.onData=function(b){this.clearCloseTimeout(),(this.connected||this.connecting||this.reconnecting)&&this.setCloseTimeout();if(b!==""){var i=d.parser.decodePayload(b);if(i&&i.length){for(var h=0,g=i.length;h<g;h++){this.onPacket(i[h])}}}return this},f.prototype.onPacket=function(b){if(b.type=="heartbeat"){return this.onHeartbeat()}b.type=="connect"&&b.endpoint==""&&this.onConnect(),this.socket.onPacket(b);return this},f.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var b=this;this.closeTimeout=setTimeout(function(){b.onDisconnect()},this.socket.closeTimeout)}},f.prototype.onDisconnect=function(){this.close&&this.open&&this.close(),this.clearTimeouts(),this.socket.onDisconnect();return this},f.prototype.onConnect=function(){this.socket.onConnect();return this},f.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},f.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},f.prototype.packet=function(b){this.send(d.parser.encodePacket(b))},f.prototype.onHeartbeat=function(b){this.packet({type:"heartbeat"})},f.prototype.onOpen=function(){this.open=!0,this.clearCloseTimeout(),this.socket.onOpen()},f.prototype.onClose=function(){var b=this;this.open=!1,this.socket.onClose(),this.onDisconnect()},f.prototype.prepareUrl=function(){var b=this.socket.options;return this.scheme()+"://"+b.host+":"+b.port+"/"+b.resource+"/"+d.protocol+"/"+this.name+"/"+this.sessid},f.prototype.ready=function(g,c){c.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(g,f,j){function h(){}function i(b){this.options={port:80,secure:!1,document:"document" in j?document:!1,resource:"socket.io",transports:f.transports,"connect timeout":10000,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":Infinity,"reopen delay":3000,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843},f.util.merge(this.options,b),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1;if(this.options["sync disconnect on unload"]&&(!this.isXDomain()||f.util.ua.hasCORS)){var c=this;f.util.on(j,"beforeunload",function(){c.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}g.Socket=i,f.util.mixin(i,f.EventEmitter),i.prototype.of=function(b){this.namespaces[b]||(this.namespaces[b]=new f.SocketNamespace(this,b),b!==""&&this.namespaces[b].packet({type:"connect"}));return this.namespaces[b]},i.prototype.publish=function(){this.emit.apply(this,arguments);var d;for(var c in this.namespaces){this.namespaces.hasOwnProperty(c)&&(d=this.of(c),d.$emit.apply(d,arguments))}},i.prototype.handshake=function(b){function n(a){a instanceof Error?p.onError(a.message):b.apply(null,a.split(":"))}var p=this,o=this.options,m=["http"+(o.secure?"s":"")+":/",o.host+":"+o.port,o.resource,f.protocol,f.util.query(this.options.query,"t="+ +(new Date))].join("/");if(this.isXDomain()&&!f.util.ua.hasCORS){var l=document.getElementsByTagName("script")[0],k=document.createElement("script");k.src=m+"&jsonp="+f.j.length,l.parentNode.insertBefore(k,l),f.j.push(function(c){n(c),k.parentNode.removeChild(k)})}else{var e=f.util.request();e.open("GET",m,!0),e.onreadystatechange=function(){e.readyState==4&&(e.onreadystatechange=h,e.status==200?n(e.responseText):!p.reconnecting&&p.onError(e.responseText))},e.send(null)}},i.prototype.getTransport=function(b){var n=b||this.transports,m;for(var l=0,k;k=n[l];l++){if(f.Transport[k]&&f.Transport[k].check(this)&&(!this.isXDomain()||f.Transport[k].xdomainCheck())){return new f.Transport[k](this,this.sessionid)}}return null},i.prototype.connect=function(b){if(this.connecting){return this}var d=this;this.handshake(function(m,l,k,c){function a(e){d.transport&&d.transport.clearTimeouts(),d.transport=d.getTransport(e);if(!d.transport){return d.publish("connect_failed")}d.transport.ready(d,function(){d.connecting=!0,d.publish("connecting",d.transport.name),d.transport.open(),d.options["connect timeout"]&&(d.connectTimeoutTimer=setTimeout(function(){if(!d.connected){d.connecting=!1;if(d.options["try multiple transports"]){d.remainingTransports||(d.remainingTransports=d.transports.slice(0));var n=d.remainingTransports;while(n.length>0&&n.splice(0,1)[0]!=d.transport.name){}n.length?a(n):d.publish("connect_failed")}}},d.options["connect timeout"]))})}d.sessionid=m,d.closeTimeout=k*1000,d.heartbeatTimeout=l*1000,d.transports=f.util.intersect(c.split(","),d.options.transports),a(),d.once("connect",function(){clearTimeout(d.connectTimeoutTimer),b&&typeof b=="function"&&b()})});return this},i.prototype.packet=function(b){this.connected&&!this.doBuffer?this.transport.packet(b):this.buffer.push(b);return this},i.prototype.setBuffer=function(b){this.doBuffer=b,!b&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])},i.prototype.disconnect=function(){this.connected&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted"));return this},i.prototype.disconnectSync=function(){var b=f.util.request(),d=this.resource+"/"+f.protocol+"/"+this.sessionid;b.open("GET",d,!0),this.onDisconnect("booted")},i.prototype.isXDomain=function(){var b=j.location.port||("https:"==j.location.protocol?443:80);return this.options.host!==j.location.hostname||this.options.port!=b},i.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},i.prototype.onOpen=function(){this.open=!0},i.prototype.onClose=function(){this.open=!1},i.prototype.onPacket=function(b){this.of(b.endpoint).onPacket(b)},i.prototype.onError=function(b){b&&b.advice&&b.advice==="reconnect"&&this.connected&&(this.disconnect(),this.reconnect()),this.publish("error",b&&b.reason?b.reason:b)},i.prototype.onDisconnect=function(d){var c=this.connected;this.connected=!1,this.connecting=!1,this.open=!1,c&&(this.transport.close(),this.transport.clearTimeouts(),this.publish("disconnect",d),"booted"!=d&&this.options.reconnect&&!this.reconnecting&&this.reconnect())},i.prototype.reconnect=function(){function m(){if(!!l.reconnecting){if(l.connected){return n()}if(l.connecting&&l.reconnecting){return l.reconnectionTimer=setTimeout(m,1000)}l.reconnectionAttempts++>=k?l.redoTransports?(l.publish("reconnect_failed"),n()):(l.on("connect_failed",m),l.options["try multiple transports"]=!0,l.transport=l.getTransport(),l.redoTransports=!0,l.connect()):(l.reconnectionDelay<o&&(l.reconnectionDelay*=2),l.connect(),l.publish("reconnecting",l.reconnectionDelay,l.reconnectionAttempts),l.reconnectionTimer=setTimeout(m,l.reconnectionDelay))}}function n(){if(l.connected){for(var a in l.namespaces){l.namespaces.hasOwnProperty(a)&&""!==a&&l.namespaces[a].packet({type:"connect"})}l.publish("reconnect",l.transport.name,l.reconnectionAttempts)}l.removeListener("connect_failed",m),l.removeListener("connect",m),l.reconnecting=!1,delete l.reconnectionAttempts,delete l.reconnectionDelay,delete l.reconnectionTimer,delete l.redoTransports,l.options["try multiple transports"]=p}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var l=this,k=this.options["max reconnection attempts"],p=this.options["try multiple transports"],o=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(m,this.reconnectionDelay),this.on("connect",m)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(f,e){function g(d,c){this.namespace=d,this.name=c}function h(d,c){this.socket=d,this.name=c||"",this.flags={},this.json=new g(this,"json"),this.ackPackets=0,this.acks={}}f.SocketNamespace=h,e.util.mixin(h,e.EventEmitter),h.prototype.$emit=e.EventEmitter.prototype.emit,h.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},h.prototype.packet=function(b){b.endpoint=this.name,this.socket.packet(b),this.flags={};return this},h.prototype.send=function(i,d){var j={type:this.flags.json?"json":"message",data:i};"function"==typeof d&&(j.id=++this.ackPackets,j.ack=!0,this.acks[j.id]=d);return this.packet(j)},h.prototype.emit=function(j){var i=Array.prototype.slice.call(arguments,1),l=i[i.length-1],k={type:"event",name:j};"function"==typeof l&&(k.id=++this.ackPackets,k.ack="data",this.acks[k.id]=l,i=i.slice(0,i.length-1)),k.args=i;return this.packet(k)},h.prototype.disconnect=function(){this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect"));return this},h.prototype.onPacket=function(b){function j(){k.packet({type:"ack",args:e.util.toArray(arguments),ackId:b.id})}var k=this;switch(b.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?this.socket.onDisconnect(b.reason||"booted"):this.$emit("disconnect",b.reason);break;case"message":case"json":var i=["message",b.data];b.ack=="data"?i.push(j):b.ack&&this.packet({type:"ack",ackId:b.id}),this.$emit.apply(this,i);break;case"event":var i=[b.name].concat(b.args);b.ack=="data"&&i.push(j),this.$emit.apply(this,i);break;case"ack":this.acks[b.ackId]&&(this.acks[b.ackId].apply(this,b.args),delete this.acks[b.ackId]);break;case"error":b.advice?this.socket.onError(b):b.reason=="unauthorized"?this.$emit("connect_failed",b.reason):this.$emit("error",b.reason)}},g.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},g.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(f,e,h){function g(b){e.Transport.apply(this,arguments)}f.websocket=g,e.util.inherit(g,e.Transport),g.prototype.name="websocket",g.prototype.open=function(){var b=e.util.query(this.socket.options.query),i=this,c;c||(c=h.MozWebSocket||h.WebSocket),this.websocket=new c(this.prepareUrl()+b),this.websocket.onopen=function(){i.onOpen(),i.socket.setBuffer(!1)},this.websocket.onmessage=function(d){i.onData(d.data)},this.websocket.onclose=function(){i.onClose(),i.socket.setBuffer(!0)},this.websocket.onerror=function(d){i.onError(d)};return this},g.prototype.send=function(b){this.websocket.send(b);return this},g.prototype.payload=function(i){for(var d=0,j=i.length;d<j;d++){this.packet(i[d])}return this},g.prototype.close=function(){this.websocket.close();return this},g.prototype.onError=function(b){this.socket.onError(b)},g.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},g.check=function(){return"WebSocket" in h&&!("__addTask" in WebSocket)||"MozWebSocket" in h},g.xdomainCheck=function(){return !0},e.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,d){function f(){d.Transport.websocket.apply(this,arguments)}e.flashsocket=f,d.util.inherit(f,d.Transport.websocket),f.prototype.name="flashsocket",f.prototype.open=function(){var b=this,g=arguments;WebSocket.__addTask(function(){d.Transport.websocket.prototype.open.apply(b,g)});return this},f.prototype.send=function(){var b=this,g=arguments;WebSocket.__addTask(function(){d.Transport.websocket.prototype.send.apply(b,g)});return this},f.prototype.close=function(){WebSocket.__tasks.length=0,d.Transport.websocket.prototype.close.call(this);return this},f.prototype.ready=function(b,h){function g(){var a=b.options,j=a["flash policy port"],i=["http"+(a.secure?"s":"")+":/",a.host+":"+a.port,a.resource,"static/flashsocket","WebSocketMain"+(b.isXDomain()?"Insecure":"")+".swf"];f.loaded||(typeof WEB_SOCKET_SWF_LOCATION=="undefined"&&(WEB_SOCKET_SWF_LOCATION=i.join("/")),j!==843&&WebSocket.loadFlashPolicyFile("xmlsocket://"+a.host+":"+j),WebSocket.__initialize(),f.loaded=!0),h.call(c)}var c=this;if(document.body){return g()}d.util.load(g)},f.check=function(){return typeof WebSocket!="undefined"&&"__initialize" in WebSocket&&!!swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},f.xdomainCheck=function(){return !0},typeof window!="undefined"&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),d.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports);if("undefined"!=typeof window){var swfobject=function(){function Y(a){var f=/[\\\"<>\.;]/,e=f.exec(a)!=null;return e&&typeof encodeURIComponent!=aU?encodeURIComponent(a):a}function Z(e,d){if(!!ax){var f=d?"visible":"hidden";aB&&ae(e)?ae(e).style.visibility=f:aa("#"+e,"visibility:"+f)}}function aa(n,m,l,k){if(!aw.ie||!aw.mac){var i=aM.getElementsByTagName("head")[0];if(!i){return}var b=l&&typeof l=="string"?l:"screen";k&&(az=null,ay=null);if(!az||ay!=b){var a=ad("style");a.setAttribute("type","text/css"),a.setAttribute("media",b),az=i.appendChild(a),aw.ie&&aw.win&&typeof aM.styleSheets!=aU&&aM.styleSheets.length>0&&(az=aM.styleSheets[aM.styleSheets.length-1]),ay=b}aw.ie&&aw.win?az&&typeof az.addRule==aT&&az.addRule(n,m):az&&typeof aM.createTextNode!=aU&&az.appendChild(aM.createTextNode(n+" {"+m+"}"))}}function ab(e){var d=aw.pv,f=e.split(".");f[0]=parseInt(f[0],10),f[1]=parseInt(f[1],10)||0,f[2]=parseInt(f[2],10)||0;return d[0]>f[0]||d[0]==f[0]&&d[1]>f[1]||d[0]==f[0]&&d[1]==f[1]&&d[2]>=f[2]?!0:!1}function ac(e,d,f){e.attachEvent(d,f),aG[aG.length]=[e,d,f]}function ad(b){return aM.createElement(b)}function ae(e){var d=null;try{d=aM.getElementById(e)}catch(f){}return d}function af(e){var d=ae(e);if(d){for(var f in d){typeof d[f]=="function"&&(d[f]=null)}d.parentNode.removeChild(d)}}function ag(d){var c=ae(d);c&&c.nodeName=="OBJECT"&&(aw.ie&&aw.win?(c.style.display="none",function(){c.readyState==4?af(d):setTimeout(arguments.callee,10)}()):c.parentNode.removeChild(c))}function ah(f,e,h){var g=ad("param");g.setAttribute("name",e),g.setAttribute("value",h),f.appendChild(g)}function ai(x,w,v){var u,t=ae(v);if(aw.wk&&aw.wk<312){return u}if(t){typeof x.id==aU&&(x.id=v);if(aw.ie&&aw.win){var s="";for(var r in x){x[r]!=Object.prototype[r]&&(r.toLowerCase()=="data"?w.movie=x[r]:r.toLowerCase()=="styleclass"?s+=' class="'+x[r]+'"':r.toLowerCase()!="classid"&&(s+=" "+r+'="'+x[r]+'"'))}var q="";for(var n in w){w[n]!=Object.prototype[n]&&(q+='<param name="'+n+'" value="'+w[n]+'" />')}t.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+s+">"+q+"</object>",aH[aH.length]=x.id,u=ae(x.id)}else{var e=ad(aT);e.setAttribute("type",aQ);for(var b in x){x[b]!=Object.prototype[b]&&(b.toLowerCase()=="styleclass"?e.setAttribute("class",x[b]):b.toLowerCase()!="classid"&&e.setAttribute(b,x[b]))}for(var a in w){w[a]!=Object.prototype[a]&&a.toLowerCase()!="movie"&&ah(e,a,w[a])}t.parentNode.replaceChild(e,t),u=e}}return u}function aj(b){var l=ad("div");if(aw.win&&aw.ie){l.innerHTML=b.innerHTML}else{var k=b.getElementsByTagName(aT)[0];if(k){var j=k.childNodes;if(j){var i=j.length;for(var h=0;h<i;h++){(j[h].nodeType!=1||j[h].nodeName!="PARAM")&&j[h].nodeType!=8&&l.appendChild(j[h].cloneNode(!0))}}}}return l}function ak(d){if(aw.ie&&aw.win&&d.readyState!=4){var c=ad("div");d.parentNode.insertBefore(c,d),c.parentNode.replaceChild(aj(d),c),d.style.display="none",function(){d.readyState==4?d.parentNode.removeChild(d):setTimeout(arguments.callee,10)}()}else{d.parentNode.replaceChild(aj(d),d)}}function al(a,p,o,n){aA=!0,aD=n||null,aC={success:!1,id:o};var m=ae(o);if(m){m.nodeName=="OBJECT"?(aF=aj(m),aE=null):(aF=m,aE=o),a.id=aP;if(typeof a.width==aU||!/%$/.test(a.width)&&parseInt(a.width,10)<310){a.width="310"}if(typeof a.height==aU||!/%$/.test(a.height)&&parseInt(a.height,10)<137){a.height="137"}aM.title=aM.title.slice(0,47)+" - Flash Player Installation";var i=aw.ie&&aw.win?"ActiveX":"PlugIn",h="MMredirectURL="+aN.location.toString().replace(/&/g,"%26")+"&MMplayerType="+i+"&MMdoctitle="+aM.title;typeof p.flashvars!=aU?p.flashvars+="&"+h:p.flashvars=h;if(aw.ie&&aw.win&&m.readyState!=4){var f=ad("div");o+="SWFObjectNew",f.setAttribute("id",o),m.parentNode.insertBefore(f,m),m.style.display="none",function(){m.readyState==4?m.parentNode.removeChild(m):setTimeout(arguments.callee,10)}()}ai(a,p,o)}}function am(){return !aA&&ab("6.0.65")&&(aw.win||aw.mac)&&!(aw.wk&&aw.wk<312)}function an(h){var g=null,b=ae(h);if(b&&b.nodeName=="OBJECT"){if(typeof b.SetVariable!=aU){g=b}else{var a=b.getElementsByTagName(aT)[0];a&&(g=a)}}return g}function ao(){var x=aI.length;if(x>0){for(var w=0;w<x;w++){var v=aI[w].id,u=aI[w].callbackFn,t={success:!1,id:v};if(aw.pv[0]>0){var s=ae(v);if(s){if(ab(aI[w].swfVersion)&&!(aw.wk&&aw.wk<312)){Z(v,!0),u&&(t.success=!0,t.ref=an(v),u(t))}else{if(aI[w].expressInstall&&am()){var r={};r.data=aI[w].expressInstall,r.width=s.getAttribute("width")||"0",r.height=s.getAttribute("height")||"0",s.getAttribute("class")&&(r.styleclass=s.getAttribute("class")),s.getAttribute("align")&&(r.align=s.getAttribute("align"));var q={},p=s.getElementsByTagName("param"),o=p.length;for(var m=0;m<o;m++){p[m].getAttribute("name").toLowerCase()!="movie"&&(q[p[m].getAttribute("name")]=p[m].getAttribute("value"))}al(r,q,v,u)}else{ak(s),u&&u(t)}}}}else{Z(v,!0);if(u){var a=an(v);a&&typeof a.SetVariable!=aU&&(t.success=!0,t.ref=a),u(t)}}}}}function ap(){var h=aM.getElementsByTagName("body")[0],e=ad(aT);e.setAttribute("type",aQ);var b=h.appendChild(e);if(b){var a=0;(function(){if(typeof b.GetVariable!=aU){var c=b.GetVariable("$version");c&&(c=c.split(" ")[1].split(","),aw.pv=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)])}else{if(a<10){a++,setTimeout(arguments.callee,10);return}}h.removeChild(e),b=null,ao()})()}else{ao()}}function aq(){aK?ap():ao()}function ar(a){if(typeof aN.addEventListener!=aU){aN.addEventListener("load",a,!1)}else{if(typeof aM.addEventListener!=aU){aM.addEventListener("load",a,!1)}else{if(typeof aN.attachEvent!=aU){ac(aN,"onload",a)}else{if(typeof aN.onload=="function"){var d=aN.onload;aN.onload=function(){d(),a()}}else{aN.onload=a}}}}}function at(b){aB?b():aJ[aJ.length]=b}function au(){if(!aB){try{var f=aM.getElementsByTagName("body")[0].appendChild(ad("span"));f.parentNode.removeChild(f)}catch(e){return}aB=!0;var h=aJ.length;for(var g=0;g<h;g++){aJ[g]()}}}var aU="undefined",aT="object",aS="Shockwave Flash",aR="ShockwaveFlash.ShockwaveFlash",aQ="application/x-shockwave-flash",aP="SWFObjectExprInst",aO="onreadystatechange",aN=window,aM=document,aL=navigator,aK=!1,aJ=[aq],aI=[],aH=[],aG=[],aF,aE,aD,aC,aB=!1,aA=!1,az,ay,ax=!0,aw=function(){var k=typeof aM.getElementById!=aU&&typeof aM.getElementsByTagName!=aU&&typeof aM.createElement!=aU,j=aL.userAgent.toLowerCase(),i=aL.platform.toLowerCase(),h=i?/win/.test(i):/win/.test(j),e=i?/mac/.test(i):/mac/.test(j),d=/webkit/.test(j)?parseFloat(j.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,c=!1,b=[0,0,0],a=null;if(typeof aL.plugins!=aU&&typeof aL.plugins[aS]==aT){a=aL.plugins[aS].description,a&&(typeof aL.mimeTypes==aU||!aL.mimeTypes[aQ]||!!aL.mimeTypes[aQ].enabledPlugin)&&(aK=!0,c=!1,a=a.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),b[0]=parseInt(a.replace(/^(.*)\..*$/,"$1"),10),b[1]=parseInt(a.replace(/^.*\.(.*)\s.*$/,"$1"),10),b[2]=/[a-zA-Z]/.test(a)?parseInt(a.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0)}else{if(typeof aN.ActiveXObject!=aU){try{var v=new ActiveXObject(aR);v&&(a=v.GetVariable("$version"),a&&(c=!0,a=a.split(" ")[1].split(","),b=[parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10)]))}catch(u){}}}return{w3:k,pv:b,wk:d,ie:c,win:h,mac:e}}(),av=function(){!aw.w3||((typeof aM.readyState!=aU&&aM.readyState=="complete"||typeof aM.readyState==aU&&(aM.getElementsByTagName("body")[0]||aM.body))&&au(),aB||(typeof aM.addEventListener!=aU&&aM.addEventListener("DOMContentLoaded",au,!1),aw.ie&&aw.win&&(aM.attachEvent(aO,function(){aM.readyState=="complete"&&(aM.detachEvent(aO,arguments.callee),au())}),aN==top&&function(){if(!aB){try{aM.documentElement.doScroll("left")}catch(b){setTimeout(arguments.callee,0);return}au()}}()),aw.wk&&function(){if(!aB){if(!/loaded|complete/.test(aM.readyState)){setTimeout(arguments.callee,0);return}au()}}(),ar(au)))}(),X=function(){aw.ie&&aw.win&&window.attachEvent("onunload",function(){var h=aG.length;for(var g=0;g<h;g++){aG[g][0].detachEvent(aG[g][1],aG[g][2])}var l=aH.length;for(var k=0;k<l;k++){ag(aH[k])}for(var j in aw){aw[j]=null}aw=null;for(var i in swfobject){swfobject[i]=null}swfobject=null})}();return{registerObject:function(g,f,j,i){if(aw.w3&&g&&f){var h={};h.id=g,h.swfVersion=f,h.expressInstall=j,h.callbackFn=i,aI[aI.length]=h,Z(g,!1)}else{i&&i({success:!1,id:g})}},getObjectById:function(b){if(aw.w3){return an(b)}},embedSWF:function(v,u,t,s,r,q,p,o,n,b){var a={success:!1,id:u};aw.w3&&!(aw.wk&&aw.wk<312)&&v&&u&&t&&s&&r?(Z(u,!1),at(function(){t+="",s+="";var h={};if(n&&typeof n===aT){for(var g in n){h[g]=n[g]}}h.data=v,h.width=t,h.height=s;var f={};if(o&&typeof o===aT){for(var e in o){f[e]=o[e]}}if(p&&typeof p===aT){for(var d in p){typeof f.flashvars!=aU?f.flashvars+="&"+d+"="+p[d]:f.flashvars=d+"="+p[d]}}if(ab(r)){var c=ai(h,f,u);h.id==u&&Z(u,!0),a.success=!0,a.ref=c}else{if(q&&am()){h.data=q,al(h,f,u,b);return}Z(u,!0)}b&&b(a)})):b&&b(a)},switchOffAutoHideShow:function(){ax=!1},ua:aw,getFlashPlayerVersion:function(){return{major:aw.pv[0],minor:aw.pv[1],release:aw.pv[2]}},hasFlashPlayerVersion:ab,createSWF:function(e,d,f){return aw.w3?ai(e,d,f):undefined},showExpressInstall:function(f,e,h,g){aw.w3&&am()&&al(f,e,h,g)},removeSWF:function(b){aw.w3&&ag(b)},createCSS:function(f,e,h,g){aw.w3&&aa(f,e,h,g)},addDomLoadEvent:at,addLoadEvent:ar,getQueryParamValue:function(f){var e=aM.location.search||aM.location.hash;if(e){/\?/.test(e)&&(e=e.split("?")[1]);if(f==null){return Y(e)}var h=e.split("&");for(var g=0;g<h.length;g++){if(h[g].substring(0,h[g].indexOf("="))==f){return Y(h[g].substring(h[g].indexOf("=")+1))}}}return""},expressInstallCallback:function(){if(aA){var b=ae(aP);b&&aF&&(b.parentNode.replaceChild(aF,b),aE&&(Z(aE,!0),aw.ie&&aw.win&&(aF.style.display="block")),aD&&aD(aC)),aA=!1}}}}()}(function(){if("undefined"!=typeof window&&!window.WebSocket){var b=window.console;if(!b||!b.log||!b.error){b={log:function(){},error:function(){}}}if(!swfobject.hasFlashPlayerVersion("10.0.0")){b.error("Flash Player >= 10.0.0 is required.");return}location.protocol=="file:"&&b.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(h,g,l,k,j){var i=this;i.__id=WebSocket.__nextId++,WebSocket.__instances[i.__id]=i,i.readyState=WebSocket.CONNECTING,i.bufferedAmount=0,i.__events={},g?typeof g=="string"&&(g=[g]):g=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(i.__id,h,g,l||null,k||0,j||null)})},0)},WebSocket.prototype.send=function(d){if(this.readyState==WebSocket.CONNECTING){throw"INVALID_STATE_ERR: Web Socket connection has not been established"}var c=WebSocket.__flash.send(this.__id,encodeURIComponent(d));if(c<0){return !0}this.bufferedAmount+=c;return !1},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,d,f){e in this.__events||(this.__events[e]=[]),this.__events[e].push(d)},WebSocket.prototype.removeEventListener=function(g,f,j){if(g in this.__events){var i=this.__events[g];for(var h=i.length-1;h>=0;--h){if(i[h]===f){i.splice(h,1);break}}}},WebSocket.prototype.dispatchEvent=function(f){var e=this.__events[f.type]||[];for(var h=0;h<e.length;++h){e[h](f)}var g=this["on"+f.type];g&&g(f)},WebSocket.prototype.__handleEvent=function(e){"readyState" in e&&(this.readyState=e.readyState),"protocol" in e&&(this.protocol=e.protocol);var d;if(e.type=="open"||e.type=="error"){d=this.__createSimpleEvent(e.type)}else{if(e.type=="close"){d=this.__createSimpleEvent("close")}else{if(e.type!="message"){throw"unknown event type: "+e.type}var f=decodeURIComponent(e.message);d=this.__createMessageEvent("message",f)}}this.dispatchEvent(d)},WebSocket.prototype.__createSimpleEvent=function(d){if(document.createEvent&&window.Event){var c=document.createEvent("Event");c.initEvent(d,!1,!1);return c}return{type:d,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,d){if(document.createEvent&&window.MessageEvent&&!window.opera){var f=document.createEvent("MessageEvent");f.initMessageEvent("message",!1,!1,d,null,null,window,null);return f}return{type:e,data:d,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(c){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(c)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation);if(!window.WEB_SOCKET_SWF_LOCATION){b.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");return}var a=document.createElement("div");a.id="webSocketContainer",a.style.position="absolute",WebSocket.__isFlashLite()?(a.style.left="0px",a.style.top="0px"):(a.style.left="-100px",a.style.top="-100px");var d=document.createElement("div");d.id="webSocketFlash",a.appendChild(d),document.body.appendChild(a),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(c){c.success||b.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var c=0;c<WebSocket.__tasks.length;++c){WebSocket.__tasks[c]()}WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){setTimeout(function(){try{var a=WebSocket.__flash.receiveEvents();for(var f=0;f<a.length;++f){WebSocket.__instances[a[f].webSocketId].__handleEvent(a[f])}}catch(e){b.error(e)}},0);return !0},WebSocket.__log=function(a){b.log(decodeURIComponent(a))},WebSocket.__error=function(a){b.error(decodeURIComponent(a))},WebSocket.__addTask=function(c){WebSocket.__flash?c():WebSocket.__tasks.push(c)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes){return !1}var c=window.navigator.mimeTypes["application/x-shockwave-flash"];return !c||!c.enabledPlugin||!c.enabledPlugin.filename?!1:c.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}})(),function(g,f,j){function h(){}function i(b){!b||(f.Transport.apply(this,arguments),this.sendBuffer=[])}g.XHR=i,f.util.inherit(i,f.Transport),i.prototype.open=function(){this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout();return this},i.prototype.payload=function(b){var m=[];for(var l=0,k=b.length;l<k;l++){m.push(f.parser.encodePacket(b[l]))}this.send(f.parser.encodePayload(m))},i.prototype.send=function(b){this.post(b);return this},i.prototype.post=function(e){function k(){this.onload=h,c.socket.setBuffer(!1)}function l(){this.readyState==4&&(this.onreadystatechange=h,c.posting=!1,this.status==200?c.socket.setBuffer(!1):c.onClose())}var c=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),j.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=k:this.sendXHR.onreadystatechange=l,this.sendXHR.send(e)},i.prototype.close=function(){this.onClose();return this},i.prototype.request=function(b){var m=f.util.request(this.socket.isXDomain()),l=f.util.query(this.socket.options.query,"t="+ +(new Date));m.open(b||"GET",this.prepareUrl()+l,!0);if(b=="POST"){try{m.setRequestHeader?m.setRequestHeader("Content-type","text/plain;charset=UTF-8"):m.contentType="text/plain"}catch(k){}}return m},i.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},i.check=function(b,k){try{if(f.util.request(k)){return !0}}catch(e){}return !1},i.xdomainCheck=function(){return i.check(null,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,d){function f(b){d.Transport.XHR.apply(this,arguments)}e.htmlfile=f,d.util.inherit(f,d.Transport.XHR),f.prototype.name="htmlfile",f.prototype.get=function(){this.doc=new ActiveXObject("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var b=this.doc.createElement("div");b.className="socketio",this.doc.body.appendChild(b),this.iframe=this.doc.createElement("iframe"),b.appendChild(this.iframe);var h=this,g=d.util.query(this.socket.options.query,"t="+ +(new Date));this.iframe.src=this.prepareUrl()+g,d.util.on(window,"unload",function(){h.destroy()})},f.prototype._=function(h,g){this.onData(h);try{var j=g.getElementsByTagName("script")[0];j.parentNode.removeChild(j)}catch(i){}},f.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(b){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},f.prototype.close=function(){this.destroy();return d.Transport.XHR.prototype.close.call(this)},f.check=function(){if("ActiveXObject" in window){try{var b=new ActiveXObject("htmlfile");return b&&d.Transport.XHR.check()}catch(g){}}return !1},f.xdomainCheck=function(){return !1},d.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(g,f,j){function h(){}function i(){f.Transport.XHR.apply(this,arguments)}g["xhr-polling"]=i,f.util.inherit(i,f.Transport.XHR),f.util.merge(i,f.Transport.XHR),i.prototype.name="xhr-polling",i.prototype.open=function(){var b=this;f.Transport.XHR.prototype.open.call(b);return !1},i.prototype.get=function(){function k(){this.onload=h,e.onData(this.responseText),e.get()}function c(){this.readyState==4&&(this.onreadystatechange=h,this.status==200?(e.onData(this.responseText),e.get()):e.onClose())}if(!!this.open){var e=this;this.xhr=this.request(),j.XDomainRequest&&this.xhr instanceof XDomainRequest?this.xhr.onload=this.xhr.onerror=k:this.xhr.onreadystatechange=c,this.xhr.send(null)}},i.prototype.onClose=function(){f.Transport.XHR.prototype.onClose.call(this);if(this.xhr){this.xhr.onreadystatechange=this.xhr.onload=h;try{this.xhr.abort()}catch(b){}this.xhr=null}},i.prototype.ready=function(b,k){var e=this;f.util.defer(function(){k.call(e)})},f.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(g,f,j){function h(b){f.Transport["xhr-polling"].apply(this,arguments),this.index=f.j.length;var d=this;f.j.push(function(c){d._(c)})}var i=j.document&&"MozAppearance" in j.document.documentElement.style;g["jsonp-polling"]=h,f.util.inherit(h,f.Transport["xhr-polling"]),h.prototype.name="jsonp-polling",h.prototype.post=function(t){function l(){s.iframe&&s.form.removeChild(s.iframe);try{n=document.createElement('<iframe name="'+s.iframeId+'">')}catch(c){n=document.createElement("iframe"),n.name=s.iframeId}n.id=s.iframeId,s.form.appendChild(n),s.iframe=n}function m(){l(),s.socket.setBuffer(!1)}var s=this,r=f.util.query(this.socket.options.query,"t="+ +(new Date)+"&i="+this.index);if(!this.form){var q=document.createElement("form"),p=document.createElement("textarea"),o=this.iframeId="socketio_iframe_"+this.index,n;q.className="socketio",q.style.position="absolute",q.style.top="-1000px",q.style.left="-1000px",q.target=o,q.method="POST",q.setAttribute("accept-charset","utf-8"),p.name="d",q.appendChild(p),document.body.appendChild(q),this.form=q,this.area=p}this.form.action=this.prepareUrl()+r,l(),this.area.value=f.JSON.stringify(t);try{this.form.submit()}catch(b){}this.iframe.attachEvent?n.onreadystatechange=function(){s.iframe.readyState=="complete"&&m()}:this.iframe.onload=m,this.socket.setBuffer(!0)},h.prototype.get=function(){var b=this,l=document.createElement("script"),k=f.util.query(this.socket.options.query,"t="+ +(new Date)+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),l.async=!0,l.src=this.prepareUrl()+k,l.onerror=function(){b.onClose()};var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(l,d),this.script=l,i&&setTimeout(function(){var c=document.createElement("iframe");document.body.appendChild(c),document.body.removeChild(c)},100)},h.prototype._=function(b){this.onData(b),this.open&&this.get();return this},h.prototype.ready=function(b,k){var d=this;if(!i){return k.call(this)}f.util.load(function(){k.call(d)})},h.check=function(){return"document" in j},h.xdomainCheck=function(){return !0},f.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);